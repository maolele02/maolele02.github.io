<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>pandas的基本使用 | maolele'blog</title><meta name="author" content="maolele"><meta name="copyright" content="maolele"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Pandas提供了3种数据类型：Series、DataFrame和Panel。Series用于保存一维数据，DataFrame用于保存二维数据，Panel用于保存三维或者可变维数据。">
<meta property="og:type" content="article">
<meta property="og:title" content="pandas的基本使用">
<meta property="og:url" content="http://example.com/2022/12/07/pandas%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="maolele&#39;blog">
<meta property="og:description" content="Pandas提供了3种数据类型：Series、DataFrame和Panel。Series用于保存一维数据，DataFrame用于保存二维数据，Panel用于保存三维或者可变维数据。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2022-12-07T04:02:27.000Z">
<meta property="article:modified_time" content="2022-12-07T04:09:53.446Z">
<meta property="article:author" content="maolele">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/12/07/pandas%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'pandas的基本使用',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-07 12:09:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="maolele'blog"><span class="site-name">maolele'blog</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">pandas的基本使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-07T04:02:27.000Z" title="发表于 2022-12-07 12:02:27">2022-12-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-07T04:09:53.446Z" title="更新于 2022-12-07 12:09:53">2022-12-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="pandas的基本使用"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Pandas提供了3种数据类型：Series、DataFrame和Panel。Series用于保存一维数据，DataFrame用于保存二维数据，Panel用于保存三维或者可变维数据。</p>
<span id="more"></span>
<h2 id="数据结构series">数据结构：Series</h2>
<p>Series本质上是含有索引的一维数组，看起来，其包含一个左侧可以自动生成(也可以手动指定)的index和右侧的values值，分别为<code>s.index</code> <code>s.values</code>进行查看。index返回一个index对象，而values则返回一个array。 Series是一个带索引的列表，为什么不使用字典？因为Series更快，其内部是向量化运行的，和迭代相比，使用Series可以获得显著的性能上的优势。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1.values</span><br><span class="line">array([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>], dtype=int64)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1.index</span><br><span class="line">RangeIndex(start=<span class="number">0</span>, stop=<span class="number">4</span>, step=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2 = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>], index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2.values</span><br><span class="line">array([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>], dtype=int64)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2.index</span><br><span class="line">Index([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="数据结构dataframe">数据结构：DataFrame</h2>
<h3 id="dataframe的定义">DataFrame的定义</h3>
<p>DataFrame(数据框)类似于Excel电子表格。创建类DataFrame实例对象的几种方式： 使用list或者ndarray对象创建DataFrame：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([[[<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>, <span class="number">5</span>], [<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>, <span class="number">3</span>]], columns=[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>])</span><br><span class="line">df = pd.DataFrame(np.zeros((<span class="number">3</span>, <span class="number">3</span>)), columns=[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>使用字典创建DataFrame：使用字典创建DataFrame实例时，利用DataFrame可以将字典的键直接设置为列索引，并且指定一个列表作为字典的值，字典的值便成为该列索引下的所有的元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], <span class="string">&#x27;y&#x27;</span>: <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>), <span class="string">&#x27;z&#x27;</span>: [<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>]&#125;)</span><br><span class="line">df = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], y=<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>), z=[<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>]))</span><br></pre></td></tr></table></figure>
<h3 id="dataframe的选取">DataFrame的选取</h3>
<p>DataFrame的行索引是从0开始的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], <span class="string">&#x27;y&#x27;</span>: <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>), <span class="string">&#x27;z&#x27;</span>: [<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>]&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.head()  <span class="comment"># 查看前5行</span></span><br><span class="line">   x  y  z</span><br><span class="line"><span class="number">0</span>  a  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="number">1</span>  b  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  c  <span class="number">3</span>  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 选取某一列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span></span><br><span class="line">Name: y, dtype: int64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.y</span><br><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span></span><br><span class="line">Name: y, dtype: int64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[:, [<span class="string">&#x27;y&#x27;</span>]]</span><br><span class="line">   y</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[:, [<span class="number">1</span>]]</span><br><span class="line">   y</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 选取多列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[:, [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>]]</span><br><span class="line">   x  y</span><br><span class="line"><span class="number">0</span>  a  <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  b  <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  c  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[:, [<span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line">   x  y</span><br><span class="line"><span class="number">0</span>  a  <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  b  <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  c  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 选取某一行</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[<span class="number">1</span>, :]</span><br><span class="line">x    b</span><br><span class="line">y    <span class="number">2</span></span><br><span class="line">z    <span class="number">5</span></span><br><span class="line">Name: <span class="number">1</span>, dtype: <span class="built_in">object</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[<span class="number">1</span>, :]</span><br><span class="line">x    b</span><br><span class="line">y    <span class="number">2</span></span><br><span class="line">z    <span class="number">5</span></span><br><span class="line">Name: <span class="number">1</span>, dtype: <span class="built_in">object</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 选取多行</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[[<span class="number">0</span>, <span class="number">1</span>], :]</span><br><span class="line">   x  y  z</span><br><span class="line"><span class="number">0</span>  a  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="number">1</span>  b  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[[<span class="number">0</span>, <span class="number">1</span>], :]</span><br><span class="line">   x  y  z</span><br><span class="line"><span class="number">0</span>  a  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 选取某个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[<span class="number">1</span>, <span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[[<span class="number">1</span>], [<span class="string">&#x27;y&#x27;</span>]]</span><br><span class="line">   y</span><br><span class="line"><span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 单条过滤</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[df.z &gt;= <span class="number">3</span>]</span><br><span class="line">   x  y  z</span><br><span class="line"><span class="number">1</span>  b  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  c  <span class="number">3</span>  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 多条过滤</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[(df.z &gt;= <span class="number">3</span>)&amp;(df.z &lt;= <span class="number">4</span>)]</span><br><span class="line">   x  y  z</span><br><span class="line"><span class="number">2</span>  c  <span class="number">3</span>  <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.query(<span class="string">&#x27;z &gt;= 3 &amp; z &lt;= 4&#x27;</span>)</span><br><span class="line">   x  y  z</span><br><span class="line"><span class="number">2</span>  c  <span class="number">3</span>  <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="dataframe的相关方法">DataFrame的相关方法</h3>
<ul>
<li><code>df.shape</code>：df的行数和列数，如<code>(3, 2)</code>，3行2列</li>
<li><code>len(df)</code>：df的行数</li>
<li><code>df.columns</code>：df的列名</li>
<li><code>df.index</code>：df的行名</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], <span class="string">&#x27;y&#x27;</span>: <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>)&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.shape</span><br><span class="line">(<span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(df)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.columns</span><br><span class="line">Index([<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.index</span><br><span class="line">RangeIndex(start=<span class="number">0</span>, stop=<span class="number">3</span>, step=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>重新定义列名：<code>df.columns = ["X", "Y", "Z"]</code></li>
<li>重新更改某列的列名：<code>df.rename(columns=&#123;'x': 'X'&#125;, inplace=True)</code>，若缺省<code>inplace</code>选项，则不会更改，而是增加新列</li>
<li><code>df.info()</code>：info属性表示打印DataFrame的属性信息</li>
<li><code>df.head()</code>：查看DataFrame前5行的数据信息，也可以生成一个int值指定显示的行数。</li>
<li><code>df.tail()</code>：查看DataFrame最后5行的数据信息，也可以生成一个int值指定显示的列数。</li>
</ul>
<h3 id="数据框的多重索引">数据框的多重索引</h3>
<p>通常DataFrame只有一列索引，但是有时候要用到多重索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(<span class="built_in">dict</span>(X=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>], year=[<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2011</span>,<span class="number">2011</span>,<span class="number">2011</span>], Value=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>]))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = df.set_index([<span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;year&#x27;</span>])  <span class="comment"># 设定df的索引为[&#x27;X&#x27;, &#x27;year&#x27;]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.head()  <span class="comment"># 显示df的前5行</span></span><br><span class="line">        Value</span><br><span class="line">X year</span><br><span class="line">A <span class="number">2010</span>      <span class="number">1</span></span><br><span class="line">B <span class="number">2010</span>      <span class="number">3</span></span><br><span class="line">C <span class="number">2010</span>      <span class="number">4</span></span><br><span class="line">A <span class="number">2011</span>      <span class="number">3</span></span><br><span class="line">B <span class="number">2011</span>      <span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[(<span class="string">&#x27;A&#x27;</span>, <span class="number">2010</span>), <span class="string">&#x27;Value&#x27;</span>]  <span class="comment"># 选择某个元素</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 选择索引&#x27;A&#x27;下某类的所有元素，slice(None)用于选择任意的id，注意，不能用&quot;:&quot;号</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[(<span class="string">&#x27;A&#x27;</span>, <span class="built_in">slice</span>(<span class="literal">None</span>)), <span class="string">&#x27;Value&#x27;</span>]</span><br><span class="line">X  year</span><br><span class="line">A  <span class="number">2010</span>    <span class="number">1</span></span><br><span class="line">   <span class="number">2011</span>    <span class="number">3</span></span><br><span class="line">Name: Value, dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="空数据框的创建">空数据框的创建</h3>
<p><code>df_empty = pd.DataFrame(columns=['x', 'y', 'z'])</code></p>
<h3 id="网格分部数据的创建">网格分部数据的创建</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]</span><br><span class="line">b = [<span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line">X, Y = np.meshgrid(a, b)</span><br><span class="line">df_grid = pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: X.flatten(), <span class="string">&#x27;y&#x27;</span>: Y.flatten()&#125;)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">df_grid创建的数据表是a和b的笛卡尔积</span></span><br><span class="line"><span class="string">df_grid：</span></span><br><span class="line"><span class="string">   x  y</span></span><br><span class="line"><span class="string">0  A  5</span></span><br><span class="line"><span class="string">1  B  5</span></span><br><span class="line"><span class="string">2  C  5</span></span><br><span class="line"><span class="string">3  A  7</span></span><br><span class="line"><span class="string">4  B  7</span></span><br><span class="line"><span class="string">5  C  7</span></span><br><span class="line"><span class="string">6  A  9</span></span><br><span class="line"><span class="string">7  B  9</span></span><br><span class="line"><span class="string">8  C  9</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="数据类型categorical">数据类型：Categorical</h3>
<p>Categorical(分类)可用于承载基于整数的类别展示或编码的数据，可分为类别型和有序型。分类数据类型可以看成是包含了额外信息的列表，这额外的信息就是不同的类别，可以称之为类别(categories)。</p>
<h2 id="表格的操作">表格的操作</h2>
<h3 id="表格的变换">表格的变换</h3>
<p>使用python的plotnine包绘图或者做分组<code>groupby()</code>计算处理时，通常是使用一维数据列表的数据框。但是如果导入的数据框表格是二维数据列表，我们需要使用<code>pd.melt()</code>函数，将二维数据列表的数据框转换成一维数据列表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建二维数据框</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;X&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>], <span class="string">&#x27;2011&#x27;</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">&#x27;2011&#x27;</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将宽数据转换为长数据：将多行聚集成列，从而二维表变成一维表</span></span><br><span class="line">df_melt = pd.melt(df, id_vars=<span class="string">&#x27;X&#x27;</span>, var_name=<span class="string">&#x27;year&#x27;</span>, value_name=<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">其中，id.vars(&quot;X&quot;)表示由标识变量构成的向量，用于表示观测的变量；</span></span><br><span class="line"><span class="string">variable.name(&quot;year&quot;)表示用于保存原始变量名的变量的名称；</span></span><br><span class="line"><span class="string">value.name(&quot;value&quot;)表示用于保存原始值的名称。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将长数据转换为宽数据：将一列根据变量展开为多行，从而一维表变二维表</span></span><br><span class="line">df_pivot = df_melt.pivot_table(index=<span class="string">&#x27;X&#x27;</span>, columns=<span class="string">&#x27;year&#x27;</span>, values=<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">df_pivot = df_pivot.reset_index()</span><br></pre></td></tr></table></figure>
<figure>
<img src="https://cdn.nlark.com/yuque/0/2022/png/32620133/1670323141228-54edaa75-de75-4a69-8e53-3f816ccda43b.png" alt="image.png" /><figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>左图每一行有多列数据，如索引为A的行，其值有1和3，所以是二维表。 右图的X和year都为行索引，每一行只有一个值。</p>
<h3 id="变量的变换">变量的变换</h3>
<p>对数据框的某列进行运算，产生并添加新的列。 可以直接对数据框的某列进行加减乘除某个数据的运算，从而产生新列： <code>df_melt['value2'] = df_melt['value']*2</code> 使用Python的apply函数，结合lambda表达式可以为原数据添加新的列，改变原变量列的值。同时结合条件语句的三元表达式<code>if else</code>进行更加复杂的运算。 <code>df_melt['value2'] = df_melt.apply(lambda x:x['value']*2 if x['year'] == "2011" else x['value'], axis=1)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df_melt1 = pd.DataFrame(<span class="built_in">dict</span>(X=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">                       year=[<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2011</span>,<span class="number">2011</span>,<span class="number">2011</span>], value=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line">df_melt1[<span class="string">&#x27;value2&#x27;</span>] = df_melt1[<span class="string">&#x27;value&#x27;</span>]*<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(df_melt1.head(<span class="number">6</span>), end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df_melt2 = pd.DataFrame(<span class="built_in">dict</span>(X=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">                       year=[<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2011</span>,<span class="number">2011</span>,<span class="number">2011</span>], value=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>]))</span><br><span class="line"><span class="comment"># 如果year索引是2011，则value2的是设为value值的2倍，如果不是，则设为value的值</span></span><br><span class="line"><span class="comment"># x if condition else y 是python的三元表达式</span></span><br><span class="line">df_melt2[<span class="string">&#x27;value2&#x27;</span>] = df_melt2.apply(<span class="keyword">lambda</span> x: x[<span class="string">&#x27;value&#x27;</span>]*<span class="number">2</span> <span class="keyword">if</span> x[<span class="string">&#x27;year&#x27;</span>] == <span class="number">2011</span> <span class="keyword">else</span> x[<span class="string">&#x27;value&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df_melt2.head(<span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   X  year  value  value2</span><br><span class="line">0  A  2010      1       2</span><br><span class="line">1  B  2010      3       6</span><br><span class="line">2  C  2010      4       8</span><br><span class="line">3  A  2011      3       6</span><br><span class="line">4  B  2011      5      10</span><br><span class="line">5  C  2011      2       4</span><br><span class="line"></span><br><span class="line">   X  year  value  value2</span><br><span class="line">0  A  2010      1       1</span><br><span class="line">1  B  2010      3       3</span><br><span class="line">2  C  2010      4       4</span><br><span class="line">3  A  2011      3       6</span><br><span class="line">4  B  2011      5      10</span><br><span class="line">5  C  2011      2       4</span><br></pre></td></tr></table></figure>
<p>apply、applymap和map方法都可以向对象中的数据传递函数，主要区别如下：</p>
<ul>
<li>apply的操作对象是DataFrame的某一列(axis=0)或者某一行(axis=1)</li>
<li>applymap的操作对象是元素级，作用于每个DataFrame的每个数据</li>
<li>map的操作对象也是元素级，但其是对Series中的每个数据调用一次函数</li>
</ul>
<h3 id="表的排序">表的排序</h3>
<p>我们可以使用<code>np.sort()</code>函数对向量进行排序处理。对于数据框，也可以使用<code>sort_values()</code>函数，根据数据框的某列数据对整个表进行排序。其中，<code>ascending=False</code>表示根据df的value列做降序处理(该参数默认为<code>True</code>，升序排序)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df_melt = pd.DataFrame(<span class="built_in">dict</span>(X=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">                       year=[<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2010</span>,<span class="number">2011</span>,<span class="number">2011</span>,<span class="number">2011</span>], value=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line">dat_sort1 = df_melt.sort_values(by=<span class="string">&#x27;value&#x27;</span>, ascending=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(dat_sort1.head(<span class="number">6</span>), end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line">dat_sort2 = df_melt.sort_values(by=<span class="string">&#x27;value&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(dat_sort2.head(<span class="number">6</span>), end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line">dat_sort3 = df_melt.sort_values(by=<span class="string">&#x27;year&#x27;</span>, ascending=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(dat_sort3.head(<span class="number">6</span>), end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">   X  year  value</span><br><span class="line">0  A  2010      1</span><br><span class="line">5  C  2011      2</span><br><span class="line">1  B  2010      3</span><br><span class="line">3  A  2011      3</span><br><span class="line">2  C  2010      4</span><br><span class="line">4  B  2011      5</span><br><span class="line"></span><br><span class="line">   X  year  value</span><br><span class="line">4  B  2011      5</span><br><span class="line">2  C  2010      4</span><br><span class="line">1  B  2010      3</span><br><span class="line">3  A  2011      3</span><br><span class="line">5  C  2011      2</span><br><span class="line">0  A  2010      1</span><br><span class="line"></span><br><span class="line">   X  year  value</span><br><span class="line">0  A  2010      1</span><br><span class="line">1  B  2010      3</span><br><span class="line">2  C  2010      4</span><br><span class="line">3  A  2011      3</span><br><span class="line">4  B  2011      5</span><br><span class="line">5  C  2011      2</span><br></pre></td></tr></table></figure>
<h3 id="表的拼接">表的拼接</h3>
<p>有时候，我们需要在已有的数据框的基础上添加新的行/列，或者横向/纵向添加另外一个表格。此时，我们需要使用<code>pd.concat()</code>函数或者<code>append()</code>函数实现该功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>], y=<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>)))</span><br><span class="line">df2 = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&quot;B&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;H&quot;</span>], g=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>]))</span><br><span class="line">df3 = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&quot;g&quot;</span>, <span class="string">&quot;d&quot;</span>], y=[<span class="number">2</span>,<span class="number">5</span>]))</span><br><span class="line"></span><br><span class="line">dat_cbind1 = pd.concat([df1, df2], axis=<span class="number">1</span>)  <span class="comment"># 沿横轴方向连接</span></span><br><span class="line"><span class="built_in">print</span>(dat_cbind1, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line">dat_rbind2 = pd.concat([df1, df3], axis=<span class="number">0</span>)  <span class="comment"># 沿纵轴方向连接</span></span><br><span class="line"><span class="built_in">print</span>(dat_rbind2, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line">dat_rbind3 = df1.append(df3)  <span class="comment"># 也是沿纵轴方向连接</span></span><br><span class="line"><span class="built_in">print</span>(dat_rbind3, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   x  y  x  g</span><br><span class="line">0  a  1  B  2</span><br><span class="line">1  b  2  D  5</span><br><span class="line">2  c  3  H  3</span><br><span class="line"></span><br><span class="line">   x  y</span><br><span class="line">0  a  1</span><br><span class="line">1  b  2</span><br><span class="line">2  c  3</span><br><span class="line">0  g  2</span><br><span class="line">1  d  5</span><br><span class="line"></span><br><span class="line">   x  y</span><br><span class="line">0  a  1</span><br><span class="line">1  b  2</span><br><span class="line">2  c  3</span><br><span class="line">0  g  2</span><br><span class="line">1  d  5</span><br></pre></td></tr></table></figure>
<h3 id="删除行列">删除行/列</h3>
<p>删除df1的"y"列： <code>df1.drop(labels="y", axis=1, inplace=True)</code> (axis默认为0，inplace默认为False，删除操作不改变原数据) 除了使用labels参数和axis参数搭配使用外，还可以使用<code>index</code>直接指定要删除的行，使用<code>columns</code>直接指定要删除的列。</p>
<h3 id="表的融合">表的融合</h3>
<p>有时候，两个数据框并没有很好地保持一致。若不一致，则不能简单地直接拼接。它们需要有一个共同的列(common key)作为融合的依据。 通过使用<code>pd.merge()</code>函数的不同参数可以实现不同的表格融合效果。其中，两个表格融合会用NA代替不存在的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>], y=<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>)))</span><br><span class="line">df2 = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;d&quot;</span>], z=<span class="built_in">range</span>(<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>)))</span><br><span class="line">df3 = pd.DataFrame(<span class="built_in">dict</span>(g=[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;d&quot;</span>], z=<span class="built_in">range</span>(<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>)))</span><br><span class="line">df4 = pd.DataFrame(<span class="built_in">dict</span>(x=[<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;d&quot;</span>], y=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>], z=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只保留左表的所有数据</span></span><br><span class="line">dat_merge1 = pd.merge(left=df1, right=df2, how=<span class="string">&quot;left&quot;</span>, on=<span class="string">&quot;x&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只保留右表的所有数据</span></span><br><span class="line">dat_merge2 = pd.merge(left=df1, right=df2, how=<span class="string">&quot;right&quot;</span>, on=<span class="string">&quot;x&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只保留两个表中公共部分的信息</span></span><br><span class="line">dat_merge3 = pd.merge(left=df1, right=df2, how=<span class="string">&quot;inner&quot;</span>, on=<span class="string">&quot;x&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保留两个表的所有信息</span></span><br><span class="line">dat_merge4 = pd.merge(left=df1, right=df2, how=<span class="string">&quot;outer&quot;</span>, on=<span class="string">&quot;x&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># on=[&quot;x&quot;, &quot;y&quot;]表示多列匹配</span></span><br><span class="line">dat_merge5 = pd.merge(left=df1, right=df4, how=<span class="string">&quot;left&quot;</span>, on=[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># left_on=&quot;x&quot;, right_on=&quot;g&quot;可以根据两个表的不同列名合并</span></span><br><span class="line"><span class="comment"># 下例df1和df3没有相同的列名，将df1的x列和df3的g列合并，保留df1的的数据</span></span><br><span class="line">dat_merge6 = pd.merge(left=df1, right=df3, how=<span class="string">&quot;left&quot;</span>, left_on=<span class="string">&quot;x&quot;</span>, right_on=<span class="string">&quot;g&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果在表合并的过程中，两个表有一列同名，但是值不同，合并时又都想保留下来</span></span><br><span class="line"><span class="comment"># 可以用suffixes给每个表的重复列名增加后缀</span></span><br><span class="line"><span class="comment"># 下例中，df1和df4都有名为y的列，两个y列在合并后列名变为y1和y2</span></span><br><span class="line">dat_merge7 = pd.merge(left=df1, right=df4, how=<span class="string">&quot;left&quot;</span>, on=<span class="string">&quot;x&quot;</span>, suffixes=[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>])</span><br></pre></td></tr></table></figure>
<h3 id="表的分组操作">表的分组操作</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;2010&#x27;</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>],</span><br><span class="line">                   <span class="string">&#x27;2011&#x27;</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">9</span>]&#125;)</span><br><span class="line"><span class="comment"># df_melt = pd.melt(df, id_vars=[&#x27;x&#x27;], var_name=&#x27;year&#x27;, value_name=&#x27;value&#x27;)</span></span><br><span class="line"><span class="comment"># df_melt.info()</span></span><br><span class="line"><span class="comment"># year是object类型，如果需要将year变为int格式，需要：</span></span><br><span class="line"><span class="comment"># df_melt[[&quot;year&quot;]] = df_melt[[&quot;year&quot;]].astype(int)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.head())</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">   x  2010  2011</span></span><br><span class="line"><span class="string">0  A     1     3</span></span><br><span class="line"><span class="string">1  B     3     5</span></span><br><span class="line"><span class="string">2  C     4     2</span></span><br><span class="line"><span class="string">3  A     4     8</span></span><br><span class="line"><span class="string">4  C     3     9</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按行求和</span></span><br><span class="line">df_rowsum = df[[<span class="string">&#x27;2010&#x27;</span>, <span class="string">&#x27;2011&#x27;</span>]].apply(<span class="keyword">lambda</span> x: x.<span class="built_in">sum</span>(), axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df_rowsum)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0     4</span></span><br><span class="line"><span class="string">1     8</span></span><br><span class="line"><span class="string">2     6</span></span><br><span class="line"><span class="string">3    12</span></span><br><span class="line"><span class="string">4    12</span></span><br><span class="line"><span class="string">dtype: int64</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 按列求和</span></span><br><span class="line">df_colsum = df[[<span class="string">&#x27;2010&#x27;</span>, <span class="string">&#x27;2011&#x27;</span>]].apply(<span class="keyword">lambda</span> x: x.<span class="built_in">sum</span>(), axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(df_colsum)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">2010    15</span></span><br><span class="line"><span class="string">2011    27</span></span><br><span class="line"><span class="string">dtype: int64</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 单列运算：在Pandas中，DataFrame的一列就是一个Series，可以通过map或者apply函数来对某一列进行操作</span></span><br><span class="line">df[<span class="string">&#x27;2010_2&#x27;</span>] = df[<span class="string">&#x27;2010&#x27;</span>].apply(<span class="keyword">lambda</span> x: x + <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head())</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">   x  2010  2011  2010_2</span></span><br><span class="line"><span class="string">0  A     1     3       3</span></span><br><span class="line"><span class="string">1  B     3     5       5</span></span><br><span class="line"><span class="string">2  C     4     2       6</span></span><br><span class="line"><span class="string">3  A     4     8       6</span></span><br><span class="line"><span class="string">4  C     3     9       5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 多列运算</span></span><br><span class="line">df[<span class="string">&#x27;2010_2011&#x27;</span>] = df.apply(<span class="keyword">lambda</span> x: x[<span class="string">&#x27;2010&#x27;</span>] + <span class="number">2</span> * x[<span class="string">&#x27;2011&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head())</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">   x  2010  2011  2010_2  2010_2011</span></span><br><span class="line"><span class="string">0  A     1     3       3          7</span></span><br><span class="line"><span class="string">1  B     3     5       5         13</span></span><br><span class="line"><span class="string">2  C     4     2       6          8</span></span><br><span class="line"><span class="string">3  A     4     8       6         20</span></span><br><span class="line"><span class="string">4  C     3     9       5         21</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="groupby函数">groupby()函数</h3>
<p>按<code>year</code>分组求均值(year值相同的为一组，每组分别计算均值)： <code>df_group_mean1 = df_melt.groupby('year').mean()</code> <img src="https://cdn.nlark.com/yuque/0/2022/png/32620133/1670327325774-ad922f4f-eda4-4116-ab6a-90b156ccc043.png" alt="image.png" /></p>
<p>按<code>year</code>和<code>x</code>两列变量分组求均值(year和x值都相同的为一组)： <code>df_group_mean2 = df_melt.groupby(['year', 'x'], as_index=False).mean()</code> 其中，<code>as_index=False</code>不会将<code>['year', 'x']</code>两列设定为索引列。 按year分组求和： <code>df_group_sum = df_melt.groupby('year').sum()</code> 按year分组求方差： <code>df_group_std = df_melt.groupby('year').std()</code></p>
<h3 id="transform函数">transform()函数</h3>
<p><code>transform()</code>函数可以结合<code>groupby</code>来方便地实现类似于SQL中的分组运算的操作： <code>df_melt['percentage'] = df_melt.groupby('x')['value'].transform(lambda x: x / x.sum())</code></p>
<h3 id="filter函数">filter()函数</h3>
<p><code>filter()</code>函数结合<code>groupby</code>来方便地实现类似SQL中的分组筛选运算的操作： <code>df_filter = df_melt.groupby('x').filter(lambda x: x['value'].mean() &gt; 4)</code></p>
<h2 id="数据的导入和导出">数据的导入和导出</h2>
<h3 id="csv格式数据的导入">CSV格式数据的导入</h3>
<p>使用<code>pd.read_csv()</code>函数，可以读入CSV格式的数据，并以DataFrame形式存储。根据所读取的数据文件编码格式设置<code>encoding</code>参数，如utf8、ansi和gbk等编码方式。 <code>df = pd.read_csv("Data.csv", sep=",", header=0, index_col=None, encoding="utf8")</code></p>
<h4 id="分隔符">分隔符</h4>
<p>根据所读取的数据文件列之间的分隔方式设定<code>sep</code>参数，<code>read_csv()</code>默认以<code>,</code>分隔。</p>
<h4 id="取消将第一行数据作为列名">取消将第一行数据作为列名</h4>
<p><code>read_csv()</code>默认<code>header=0</code>，即将第一行数据视为列名。 如果数据中没有列名，应设置参数<code>header=None</code>，会自动设置默认的列名(0, 1, 2, 3, 4...)。</p>
<h4 id="自定义列名">自定义列名</h4>
<p>设置参数<code>names</code>可以设置自定义列名，如：<code>names=['a', 'b', 'c', 'd', 'message']</code>可以将列表中的值设置为列名。(<code>names</code>结合<code>header=None</code>使用)</p>
<h4 id="将列索引变为行索引">将列索引变为行索引</h4>
<p>设置参数<code>index_col</code>为某个列名，该列的值会被设置为行索引(也可以设定为多个列名组成的列表，即多重索引) <code>df = pd.read_csv("Data.csv", index_col='message', encoding="utf8")</code></p>
<h3 id="csv数据格式的导出">CSV数据格式的导出</h3>
<p><code>df.to_csv("Data.csv", index=False, header=True)</code> <code>index=False</code>表示忽略索引信息；<code>index=True</code>表示输出文件的第一列保留索引值。</p>
<h3 id="txt格式数据的导入">TXT格式数据的导入</h3>
<p><code>df = pd.read_table('Data.txt', sep='\s+')</code> <code>read_table()</code>默认以<code>\t</code>作为分隔符，<code>\s+</code>代表一个或多个空格。 当行数比列数多时，会自动将第一列视为行索引。</p>
<h3 id="txt格式数据的导出">TXT格式数据的导出</h3>
<p><code>df.to_csv('Data.txt', sep='\t', index=False)</code></p>
<h3 id="excel格式数据的导入和导出">Excel格式数据的导入和导出</h3>
<h4 id="导入">导入</h4>
<p><code>df = read_excel("data.xlsx", sheetname='sheetname', header=0)</code> <code>sheetname</code>指定页面sheet，默认为0；<code>header</code>指定列名行，默认为0。</p>
<h4 id="导出">导出</h4>
<p><code>df.to_excel(excel_write, sheet_name='sheetname', index=False)</code> <code>excel_write</code>表示目标路径；<code>index=False</code>表示忽略索引列。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">maolele</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/12/07/pandas%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">http://example.com/2022/12/07/pandas%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">maolele'blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/11/27/ST%E8%A7%A3%E5%86%B3RMQ%E9%97%AE%E9%A2%98/" title="ST解决RMQ问题"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ST解决RMQ问题</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">maolele</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84series"><span class="toc-number">1.</span> <span class="toc-text">数据结构：Series</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84dataframe"><span class="toc-number">2.</span> <span class="toc-text">数据结构：DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dataframe%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">2.1.</span> <span class="toc-text">DataFrame的定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dataframe%E7%9A%84%E9%80%89%E5%8F%96"><span class="toc-number">2.2.</span> <span class="toc-text">DataFrame的选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dataframe%E7%9A%84%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text">DataFrame的相关方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A1%86%E7%9A%84%E5%A4%9A%E9%87%8D%E7%B4%A2%E5%BC%95"><span class="toc-number">2.4.</span> <span class="toc-text">数据框的多重索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E6%95%B0%E6%8D%AE%E6%A1%86%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.5.</span> <span class="toc-text">空数据框的创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E6%A0%BC%E5%88%86%E9%83%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.6.</span> <span class="toc-text">网格分部数据的创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8Bcategorical"><span class="toc-number">2.7.</span> <span class="toc-text">数据类型：Categorical</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">表格的操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E7%9A%84%E5%8F%98%E6%8D%A2"><span class="toc-number">3.1.</span> <span class="toc-text">表格的变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E5%8F%98%E6%8D%A2"><span class="toc-number">3.2.</span> <span class="toc-text">变量的变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E6%8E%92%E5%BA%8F"><span class="toc-number">3.3.</span> <span class="toc-text">表的排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E6%8B%BC%E6%8E%A5"><span class="toc-number">3.4.</span> <span class="toc-text">表的拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%8C%E5%88%97"><span class="toc-number">3.5.</span> <span class="toc-text">删除行&#x2F;列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E8%9E%8D%E5%90%88"><span class="toc-number">3.6.</span> <span class="toc-text">表的融合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%88%86%E7%BB%84%E6%93%8D%E4%BD%9C"><span class="toc-number">3.7.</span> <span class="toc-text">表的分组操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#groupby%E5%87%BD%E6%95%B0"><span class="toc-number">3.8.</span> <span class="toc-text">groupby()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#transform%E5%87%BD%E6%95%B0"><span class="toc-number">3.9.</span> <span class="toc-text">transform()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filter%E5%87%BD%E6%95%B0"><span class="toc-number">3.10.</span> <span class="toc-text">filter()函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA"><span class="toc-number">4.</span> <span class="toc-text">数据的导入和导出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#csv%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="toc-number">4.1.</span> <span class="toc-text">CSV格式数据的导入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">4.1.1.</span> <span class="toc-text">分隔符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E5%B0%86%E7%AC%AC%E4%B8%80%E8%A1%8C%E6%95%B0%E6%8D%AE%E4%BD%9C%E4%B8%BA%E5%88%97%E5%90%8D"><span class="toc-number">4.1.2.</span> <span class="toc-text">取消将第一行数据作为列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%97%E5%90%8D"><span class="toc-number">4.1.3.</span> <span class="toc-text">自定义列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E5%88%97%E7%B4%A2%E5%BC%95%E5%8F%98%E4%B8%BA%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.4.</span> <span class="toc-text">将列索引变为行索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#csv%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%AF%BC%E5%87%BA"><span class="toc-number">4.2.</span> <span class="toc-text">CSV数据格式的导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#txt%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="toc-number">4.3.</span> <span class="toc-text">TXT格式数据的导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#txt%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%87%BA"><span class="toc-number">4.4.</span> <span class="toc-text">TXT格式数据的导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#excel%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA"><span class="toc-number">4.5.</span> <span class="toc-text">Excel格式数据的导入和导出</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5"><span class="toc-number">4.5.1.</span> <span class="toc-text">导入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA"><span class="toc-number">4.5.2.</span> <span class="toc-text">导出</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/12/07/pandas%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" title="pandas的基本使用">pandas的基本使用</a><time datetime="2022-12-07T04:02:27.000Z" title="发表于 2022-12-07 12:02:27">2022-12-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/11/27/ST%E8%A7%A3%E5%86%B3RMQ%E9%97%AE%E9%A2%98/" title="ST解决RMQ问题">ST解决RMQ问题</a><time datetime="2022-11-27T05:25:31.000Z" title="发表于 2022-11-27 13:25:31">2022-11-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/11/26/%E4%B8%8D%E5%90%89%E5%88%A9%E7%9A%84%E6%95%B0%E5%AD%97-%E6%95%B0%E4%BD%8DDP/" title="不吉利的数字(数位DP)">不吉利的数字(数位DP)</a><time datetime="2022-11-26T05:27:19.000Z" title="发表于 2022-11-26 13:27:19">2022-11-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/11/15/%E7%88%AC%E5%8F%96vilipix%E7%9A%84%E6%8E%A8%E8%8D%90%E3%80%81%E6%AF%8F%E6%97%A5%E6%8E%92%E8%A1%8C%E5%92%8C%E5%8E%9F%E5%88%9B%E4%BD%9C%E5%93%81/" title="爬取vilipix的推荐、每日排行和原创作品">爬取vilipix的推荐、每日排行和原创作品</a><time datetime="2022-11-15T01:40:19.000Z" title="发表于 2022-11-15 09:40:19">2022-11-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By maolele</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"left","width":145,"height":315,"hOffset":60,"vOffset":10},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>